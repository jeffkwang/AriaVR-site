{{- if .Site.IsServer -}}
    <!-- Dont add Google analytics to localhost -->
{{ else }}
    <!-- Google Tag Manager -->
      <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-NZCL9QVJ');
      </script>
    <!-- End Google Tag Manager -->

    {{ $gid := (getenv "HUGO_GOOGLE_ANALYTICS_ID") }}
    {{ if $gid }}
        <!-- Global site tag (gtag.js) - Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id={{- $gid -}}"></script>
        <script>
          window.dataLayer = window.dataLayer || [];

          function gtag() {
            dataLayer.push(arguments);
          }

          gtag('js', new Date());
          gtag('config', '{{- $gid -}}');
        </script>
    {{ else }}
        {{ if .Site.Params.google_analytics_id }}
            <!-- Global site tag (gtag.js) - Google Analytics -->
            <script async
                    src="https://www.googletagmanager.com/gtag/js?id={{- .Site.Params.google_analytics_id -}}"></script>
            <script>
              window.dataLayer = window.dataLayer || [];

              function gtag() {
                dataLayer.push(arguments);
              }

              gtag('js', new Date());
              gtag('config', '{{- .Site.Params.google_analytics_id -}}');
            </script>
        {{ end }}
    {{ end}}
{{ end }}